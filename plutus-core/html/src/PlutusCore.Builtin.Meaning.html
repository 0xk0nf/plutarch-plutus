<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                 #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances         #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses     #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds                 #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures  #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications          #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies              #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators             #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances      #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE StrictData                #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusCore.Builtin.Meaning</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusPrelude.html"><span class="hs-identifier">PlutusPrelude</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Elaborate.html"><span class="hs-identifier">PlutusCore.Builtin.Elaborate</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.HasConstant.html"><span class="hs-identifier">PlutusCore.Builtin.HasConstant</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownKind.html"><span class="hs-identifier">PlutusCore.Builtin.KnownKind</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html"><span class="hs-identifier">PlutusCore.Builtin.KnownType</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownTypeAst.html"><span class="hs-identifier">PlutusCore.Builtin.KnownTypeAst</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html"><span class="hs-identifier">PlutusCore.Builtin.Runtime</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.TypeScheme.html"><span class="hs-identifier">PlutusCore.Builtin.TypeScheme</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Core.html"><span class="hs-identifier">PlutusCore.Core</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Name.html"><span class="hs-identifier">PlutusCore.Name</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/array-0.5.4.0/src"><span class="hs-identifier">Data.Array</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/12m626qdhg61qnq44614xjh4avrzhzw4-some-lib-some-1.0.3-haddock-doc/share/doc/some/html/src"><span class="hs-identifier">Data.Some.GADT</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">inline</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Turn a list of Haskell types @args@ into a functional type ending in @res@.</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XDataKinds</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- &gt;&gt;&gt; :kind! FoldArgs [(), Bool] Integer</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- FoldArgs [(), Bool] Integer :: *</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- = () -&gt; Bool -&gt; Integer</span><span>
</span><span id="line-43"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="FoldArgs"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-var">FoldArgs</span></a></span></span><span> </span><span id="local-6989586621681039967"><span class="annot"><a href="#local-6989586621681039967"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621681039966"><span class="annot"><a href="#local-6989586621681039966"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>    </span><span id="FoldArgs"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-var">FoldArgs</span></a></span></span><span> </span><span id="local-6989586621681039965"><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="annot"><a href="#local-6989586621681039965"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681039965"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span id="FoldArgs"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-var">FoldArgs</span></a></span></span><span> </span><span id="local-6989586621681039962"><span id="local-6989586621681039963"><span id="local-6989586621681039964"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681039964"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621681039963"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681039962"><span class="hs-identifier hs-type">res</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681039964"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-type">FoldArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039963"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039962"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | The meaning of a built-in function consists of its type represented as a 'TypeScheme',</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- its Haskell denotation and a costing function (both in uninstantiated form).</span><span>
</span><span id="line-49"></span><span class="hs-comment">--</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- The 'TypeScheme' of a built-in function is used for</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- 1. computing the PLC type of the function to be used during type checking</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- 2. checking equality of the expected type of an argument of a builtin and the actual one</span><span>
</span><span id="line-54"></span><span class="hs-comment">--    during evaluation, so that we can avoid unsafe-coercing</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- A costing function for a built-in function is computed from a cost model for all built-in</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- functions from a certain set, hence the @cost@ parameter.</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- The denotation is lazy, so that we don't need to worry about a builtin being bottom</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- (happens in tests). The production path is not affected by that, since only runtime denotations</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- are used for evaluation.</span><span>
</span><span id="line-62"></span><span class="hs-keyword">data</span><span> </span><span id="BuiltinMeaning"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-var">BuiltinMeaning</span></a></span></span><span> </span><span id="local-6989586621681040000"><span class="annot"><a href="#local-6989586621681040000"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span id="local-6989586621681039997"><span class="annot"><a href="#local-6989586621681039997"><span class="hs-identifier hs-type">cost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681039961"><span class="annot"><a href="#local-6989586621681039961"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621681039960"><span class="annot"><a href="#local-6989586621681039960"><span class="hs-identifier hs-type">res</span></a></span></span><span class="hs-operator">.</span><span> </span><span id="BuiltinMeaning"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-var">BuiltinMeaning</span></a></span></span><span>
</span><span id="line-64"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.TypeScheme.html#TypeScheme"><span class="hs-identifier hs-type">TypeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040000"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039961"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039960"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-type">FoldArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039961"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039960"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntimeOptions"><span class="hs-identifier hs-type">BuiltinRuntimeOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039961"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681040000"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039997"><span class="hs-identifier hs-type">cost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Constraints available when defining a built-in function.</span><span>
</span><span id="line-69"></span><span class="hs-keyword">type</span><span> </span><span id="HasMeaningIn"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#HasMeaningIn"><span class="hs-identifier hs-var">HasMeaningIn</span></a></span></span><span> </span><span id="local-6989586621681039958"><span class="annot"><a href="#local-6989586621681039958"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681039957"><span class="annot"><a href="#local-6989586621681039957"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039957"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.HasConstant.html#HasConstantIn"><span class="hs-identifier hs-type">HasConstantIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039958"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039957"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | A type class for \&quot;each function from a set of built-in functions has a 'BuiltinMeaning'\&quot;.</span><span>
</span><span id="line-72"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040149"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Bounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ToBuiltinMeaning"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ToBuiltinMeaning"><span class="hs-identifier hs-var">ToBuiltinMeaning</span></a></span></span><span> </span><span id="local-6989586621681040149"><span class="annot"><a href="#local-6989586621681040149"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681040148"><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- | The @cost@ part of 'BuiltinMeaning'.</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="CostingPart"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#CostingPart"><span class="hs-identifier hs-var">CostingPart</span></a></span></span><span> </span><span id="local-6989586621681040149"><span class="annot"><a href="#local-6989586621681040149"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681040148"><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">-- | Get the 'BuiltinMeaning' of a built-in function.</span><span>
</span><span id="line-77"></span><span>    </span><span id="toBuiltinMeaning"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toBuiltinMeaning"><span class="hs-identifier hs-type">toBuiltinMeaning</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681040132"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#HasMeaningIn"><span class="hs-identifier hs-type">HasMeaningIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040149"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040132"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-type">BuiltinMeaning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040132"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#CostingPart"><span class="hs-identifier hs-type">CostingPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040149"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040148"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Get the type of a built-in function.</span><span>
</span><span id="line-80"></span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#typeOfBuiltinFunction"><span class="hs-identifier hs-type">typeOfBuiltinFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681040146"><span class="annot"><a href="#local-6989586621681040146"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681040145"><span class="annot"><a href="#local-6989586621681040145"><span class="hs-identifier hs-type">fun</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ToBuiltinMeaning"><span class="hs-identifier hs-type">ToBuiltinMeaning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040146"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040145"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681040145"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040146"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span id="typeOfBuiltinFunction"><span class="annot"><span class="annottext">typeOfBuiltinFunction :: forall (uni :: * -&gt; *) fun.
ToBuiltinMeaning uni fun =&gt;
fun -&gt; Type TyName uni ()
</span><a href="PlutusCore.Builtin.Meaning.html#typeOfBuiltinFunction"><span class="hs-identifier hs-var hs-var">typeOfBuiltinFunction</span></a></span></span><span> </span><span id="local-6989586621681039930"><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681039930"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun val.
(ToBuiltinMeaning uni fun, HasMeaningIn uni val) =&gt;
fun -&gt; BuiltinMeaning val (CostingPart uni fun)
</span><a href="PlutusCore.Builtin.Meaning.html#toBuiltinMeaning"><span class="hs-identifier hs-var">toBuiltinMeaning</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040146"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040145"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681039930"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-type">BuiltinMeaning</span></a></span><span> </span><span id="local-6989586621681039929"><span class="annot"><span class="annottext">TypeScheme (Term TyName Name uni fun ()) args res
</span><a href="#local-6989586621681039929"><span class="hs-identifier hs-var">sch</span></a></span></span><span> </span><span class="annot"><span class="annottext">FoldArgs args res
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BuiltinRuntimeOptions
  (Length args) (Term TyName Name uni fun ()) (CostingPart uni fun)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeScheme (Term TyName Name uni fun ()) args res
-&gt; Type TyName (UniOf (Term TyName Name uni fun ())) ()
forall val (args :: [*]) res.
TypeScheme val args res -&gt; Type TyName (UniOf val) ()
</span><a href="PlutusCore.Builtin.TypeScheme.html#typeSchemeToType"><span class="hs-identifier hs-var">typeSchemeToType</span></a></span><span> </span><span class="annot"><span class="annottext">TypeScheme (Term TyName Name uni fun ()) args res
</span><a href="#local-6989586621681039929"><span class="hs-identifier hs-var">sch</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">{- Note [Automatic derivation of type schemes]
We use two type classes for automatic derivation of type/runtime schemes and runtime denotations:
'KnownPolytype' and 'KnownMonotype'.
The terminology is due to https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system#The_Hindley%E2%80%93Milner_type_system

Check out the source of &quot;PlutusCore.Builtin.Runtime&quot; for an explanation of what a runtime
denotation is.

'KnownPolytype' and 'KnownMonotype' are responsible for deriving polymorphic and monomorphic types,
respectively.

'KnownPolytype' turns every bound variable into a 'TypeSchemeAll'/'RuntimeSchemeAll'. We extract
variables from the type of the Haskell denotation using the 'ToBinds' associated type
family. Variables are collected in the order that they appear in (i.e. just like in Haskell). For
example, processing a type like

      :: ( a ~ Opaque val (TyVarRep ('TyNameRep &quot;a&quot; 0))
         , b ~ Opaque val (TyVarRep ('TyNameRep &quot;b&quot; 1))
         )
      =&gt; b -&gt; a -&gt; b

with 'ToBinds' results in the following list of bindings:

    '[ 'Some ('TyNameRep &quot;b&quot; 1), 'Some ('TyNameRep &quot;a&quot; 0) ]

'KnownMonotype' turns every argument that the Haskell denotation of a builtin receives into a
'TypeSchemeArrow'/'RuntimeSchemeArrow'. We extract the arguments from the type of the Haskell
denotation using the 'GetArgs' type family.

Higher-kinded type variables are fully supported.

At this point in the pipeline the type of the denotation of a builtin is assumed to be fully
elaborated (i.e. monomorphic).
-}</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Compute the length of a type-level list.</span><span>
</span><span id="line-120"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681039927"><span class="annot"><a href="#local-6989586621681039927"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681039927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Peano"><span class="hs-identifier hs-type">Peano</span></a></span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Length"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-var">Length</span></a></span></span><span> </span><span id="local-6989586621681039926"><span class="annot"><a href="#local-6989586621681039926"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>    </span><span id="Length"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-var">Length</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span id="Length"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-var">Length</span></a></span></span><span> </span><span id="local-6989586621681039925"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621681039925"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039925"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | Chop a function type to get a list of its argument types.</span><span>
</span><span id="line-126"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#GetArgs"><span class="hs-identifier hs-type">GetArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">GHC.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">GHC.Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="GetArgs"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#GetArgs"><span class="hs-identifier hs-var">GetArgs</span></a></span></span><span> </span><span id="local-6989586621681039924"><span class="annot"><a href="#local-6989586621681039924"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>    </span><span id="GetArgs"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#GetArgs"><span class="hs-identifier hs-var">GetArgs</span></a></span></span><span> </span><span id="local-6989586621681039922"><span id="local-6989586621681039923"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681039923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681039922"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681039923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#GetArgs"><span class="hs-identifier hs-type">GetArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039922"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span id="GetArgs"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#GetArgs"><span class="hs-identifier hs-var">GetArgs</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | A class that allows us to derive a monotype for a builtin.</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- We could've easily computed a 'RuntimeScheme' from a 'TypeScheme' but not statically (due to</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- unfolding not working for recursive functions and 'TypeScheme' being recursive, i.e. requiring</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- the conversion function to be recursive), and so it would cause us to retain a lot of</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- evaluation-irrelevant stuff in the constructors of 'TypeScheme', which makes it much harder to</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- read the Core. Technically speaking, we could convert a 'TypeScheme' to a 'RuntimeScheme'</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- statically if we changed the definition of 'TypeScheme' and made it a singleton, but then the</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- conversion function would have to become a class anyway and we'd just replicate what we have</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- here, except in a much more complicated way. It's also more efficient to generate</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- 'RuntimeScheme's directly, but that shouldn't really matter, given that they are only computed</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- once and get cached afterwards.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- Similarly, we could've computed the runtime denotations ('toImmediateF' and 'toDeferredF')</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- from a 'TypeScheme' but not statically again, and that would break inlining and basically all</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- the optimization.</span><span>
</span><span id="line-146"></span><span class="hs-keyword">class</span><span> </span><span id="KnownMonotype"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownMonotype"><span class="hs-identifier hs-var">KnownMonotype</span></a></span></span><span> </span><span id="local-6989586621681040115"><span class="annot"><a href="#local-6989586621681040115"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span id="local-6989586621681040114"><span class="annot"><a href="#local-6989586621681040114"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621681040113"><span class="annot"><a href="#local-6989586621681040113"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="knownMonotype"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#knownMonotype"><span class="hs-identifier hs-type">knownMonotype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.TypeScheme.html#TypeScheme"><span class="hs-identifier hs-type">TypeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040115"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040114"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040113"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span id="knownMonoruntime"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#knownMonoruntime"><span class="hs-identifier hs-type">knownMonoruntime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040114"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">-- | Convert the denotation of a builtin to its runtime counterpart with immediate unlifting.</span><span>
</span><span id="line-151"></span><span>    </span><span id="toImmediateF"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toImmediateF"><span class="hs-identifier hs-type">toImmediateF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-type">FoldArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040114"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040113"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-type">ToRuntimeDenotationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040115"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040114"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-comment">-- | Convert the denotation of a builtin to its runtime counterpart with deferred unlifting.</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-comment">-- The argument is in 'ReadKnownM', because that's what deferred unlifting amounts to:</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- passing the action returning the builtin application around until full saturation, which is</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">-- when the action actually gets run.</span><span>
</span><span id="line-157"></span><span>    </span><span id="toDeferredF"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toDeferredF"><span class="hs-identifier hs-type">toDeferredF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html#ReadKnownM"><span class="hs-identifier hs-type">ReadKnownM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-type">FoldArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040114"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040113"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-type">ToRuntimeDenotationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040115"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040114"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Once we've run out of term-level arguments, we return a</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- 'TypeSchemeResult'/'RuntimeSchemeResult'.</span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681040109"><span id="local-6989586621681040110"><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040110"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownTypeAst.html#KnownTypeAst"><span class="hs-identifier hs-type">KnownTypeAst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#UniOf"><span class="hs-identifier hs-type">UniOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040109"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681040110"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html#MakeKnown"><span class="hs-identifier hs-type">MakeKnown</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040109"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040110"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-162"></span><span>            </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownMonotype"><span class="hs-identifier hs-type">KnownMonotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040109"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681040110"><span class="hs-identifier hs-type">res</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621681039905"><span class="annot"><span class="annottext">knownMonotype :: TypeScheme val '[] res
</span><a href="#local-6989586621681039905"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownMonotype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeScheme val '[] res
forall res val.
(Typeable res, KnownTypeAst (UniOf val) res, MakeKnown val res) =&gt;
TypeScheme val '[] res
</span><a href="PlutusCore.Builtin.TypeScheme.html#TypeSchemeResult"><span class="hs-identifier hs-var">TypeSchemeResult</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621681039903"><span class="annot"><span class="annottext">knownMonoruntime :: RuntimeScheme (Length '[])
</span><a href="#local-6989586621681039903"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownMonoruntime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme 'Z
RuntimeScheme (Length '[])
</span><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeResult"><span class="hs-identifier hs-var">RuntimeSchemeResult</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621681039900"><span class="annot"><span class="annottext">toImmediateF :: FoldArgs '[] res -&gt; ToRuntimeDenotationType val (Length '[])
</span><a href="#local-6989586621681039900"><span class="hs-identifier hs-var hs-var hs-var hs-var">toImmediateF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoldArgs '[] res -&gt; ToRuntimeDenotationType val (Length '[])
forall (uni :: * -&gt; *) val a.
MakeKnownIn uni val a =&gt;
a -&gt; MakeKnownM val
</span><a href="PlutusCore.Builtin.KnownType.html#makeKnown"><span class="hs-identifier hs-var">makeKnown</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toImmediateF"><span class="hs-pragma hs-type">toImmediateF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-comment">-- For deferred unlifting we need to lift the 'ReadKnownM' action into 'MakeKnownM',</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- hence 'liftReadKnownM'.</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621681039895"><span class="annot"><span class="annottext">toDeferredF :: ReadKnownM (FoldArgs '[] res)
-&gt; ToRuntimeDenotationType val (Length '[])
</span><a href="#local-6989586621681039895"><span class="hs-identifier hs-var hs-var hs-var hs-var">toDeferredF</span></a></span></span><span> </span><span id="local-6989586621681039894"><span class="annot"><span class="annottext">ReadKnownM (FoldArgs '[] res)
</span><a href="#local-6989586621681039894"><span class="hs-identifier hs-var">getRes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadKnownM res -&gt; MakeKnownM res
forall a. ReadKnownM a -&gt; MakeKnownM a
</span><a href="PlutusCore.Builtin.KnownType.html#liftReadKnownM"><span class="hs-identifier hs-var">liftReadKnownM</span></a></span><span> </span><span class="annot"><span class="annottext">ReadKnownM res
ReadKnownM (FoldArgs '[] res)
</span><a href="#local-6989586621681039894"><span class="hs-identifier hs-var">getRes</span></a></span><span> </span><span class="annot"><span class="annottext">MakeKnownM res -&gt; (res -&gt; MakeKnownM val) -&gt; MakeKnownM val
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">res -&gt; MakeKnownM val
forall (uni :: * -&gt; *) val a.
MakeKnownIn uni val a =&gt;
a -&gt; MakeKnownM val
</span><a href="PlutusCore.Builtin.KnownType.html#makeKnown"><span class="hs-identifier hs-var">makeKnown</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toDeferredF"><span class="hs-pragma hs-type">toDeferredF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Every term-level argument becomes a 'TypeSchemeArrow'/'RuntimeSchemeArrow'.</span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621681040090"><span id="local-6989586621681040091"><span id="local-6989586621681040092"><span id="local-6989586621681040093"><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040093"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownTypeAst.html#KnownTypeAst"><span class="hs-identifier hs-type">KnownTypeAst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#UniOf"><span class="hs-identifier hs-type">UniOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681040093"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html#MakeKnown"><span class="hs-identifier hs-type">MakeKnown</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040093"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html#ReadKnown"><span class="hs-identifier hs-type">ReadKnown</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040093"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownMonotype"><span class="hs-identifier hs-type">KnownMonotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040091"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040090"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownMonotype"><span class="hs-identifier hs-type">KnownMonotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681040093"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621681040091"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681040090"><span class="hs-identifier hs-type">res</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621681039877"><span class="annot"><span class="annottext">knownMonotype :: TypeScheme val (arg : args) res
</span><a href="#local-6989586621681039877"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownMonotype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeScheme val args res -&gt; TypeScheme val (arg : args) res
forall arg val (args1 :: [*]) res.
(Typeable arg, KnownTypeAst (UniOf val) arg, MakeKnown val arg,
 ReadKnown val arg) =&gt;
TypeScheme val args1 res -&gt; TypeScheme val (arg : args1) res
</span><a href="PlutusCore.Builtin.TypeScheme.html#TypeSchemeArrow"><span class="hs-identifier hs-var">TypeSchemeArrow</span></a></span><span> </span><span class="annot"><span class="annottext">TypeScheme val args res
forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
TypeScheme val args res
</span><a href="PlutusCore.Builtin.Meaning.html#knownMonotype"><span class="hs-identifier hs-var">knownMonotype</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621681039874"><span class="annot"><span class="annottext">knownMonoruntime :: RuntimeScheme (Length (arg : args))
</span><a href="#local-6989586621681039874"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownMonoruntime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme (Length args) -&gt; RuntimeScheme ('S (Length args))
forall (n1 :: Peano). RuntimeScheme n1 -&gt; RuntimeScheme ('S n1)
</span><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeArrow"><span class="hs-identifier hs-var">RuntimeSchemeArrow</span></a></span><span> </span><span class="annot"><span class="annottext">(RuntimeScheme (Length args) -&gt; RuntimeScheme ('S (Length args)))
-&gt; RuntimeScheme (Length args) -&gt; RuntimeScheme ('S (Length args))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
RuntimeScheme (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#knownMonoruntime"><span class="hs-identifier hs-var">knownMonoruntime</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040091"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040090"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- Unlift, then recurse.</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621681039868"><span class="annot"><span class="annottext">toImmediateF :: FoldArgs (arg : args) res
-&gt; ToRuntimeDenotationType val (Length (arg : args))
</span><a href="#local-6989586621681039868"><span class="hs-identifier hs-var hs-var hs-var hs-var">toImmediateF</span></a></span></span><span> </span><span id="local-6989586621681039867"><span class="annot"><span class="annottext">FoldArgs (arg : args) res
</span><a href="#local-6989586621681039867"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(arg -&gt; ToRuntimeDenotationType val (Length args))
-&gt; Either KnownTypeError arg
-&gt; Either
     KnownTypeError (ToRuntimeDenotationType val (Length args))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
FoldArgs args res -&gt; ToRuntimeDenotationType val (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#toImmediateF"><span class="hs-identifier hs-var">toImmediateF</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040091"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040090"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><span class="annottext">(FoldArgs args res -&gt; ToRuntimeDenotationType val (Length args))
-&gt; (arg -&gt; FoldArgs args res)
-&gt; arg
-&gt; ToRuntimeDenotationType val (Length args)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">FoldArgs (arg : args) res
arg -&gt; FoldArgs args res
</span><a href="#local-6989586621681039867"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either KnownTypeError arg
 -&gt; Either
      KnownTypeError (ToRuntimeDenotationType val (Length args)))
-&gt; (val -&gt; Either KnownTypeError arg)
-&gt; val
-&gt; Either
     KnownTypeError (ToRuntimeDenotationType val (Length args))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">val -&gt; Either KnownTypeError arg
forall (uni :: * -&gt; *) val a.
ReadKnownIn uni val a =&gt;
val -&gt; ReadKnownM a
</span><a href="PlutusCore.Builtin.KnownType.html#readKnown"><span class="hs-identifier hs-var">readKnown</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toImmediateF"><span class="hs-pragma hs-type">toImmediateF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- Grow the builtin application within the received action and recurse on the result.</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621681039859"><span class="annot"><span class="annottext">toDeferredF :: ReadKnownM (FoldArgs (arg : args) res)
-&gt; ToRuntimeDenotationType val (Length (arg : args))
</span><a href="#local-6989586621681039859"><span class="hs-identifier hs-var hs-var hs-var hs-var">toDeferredF</span></a></span></span><span> </span><span id="local-6989586621681039858"><span class="annot"><span class="annottext">ReadKnownM (FoldArgs (arg : args) res)
</span><a href="#local-6989586621681039858"><span class="hs-identifier hs-var">getF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681039857"><span class="annot"><span class="annottext">val
</span><a href="#local-6989586621681039857"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-comment">-- The bang is very important: without it GHC thinks that the argument may not be needed in</span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-comment">-- the end and so creates a thunk for it, which is not only unnecessary allocation, but also</span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-comment">-- prevents things from being unboxed. So ironically computing the unlifted value strictly</span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-comment">-- is the best way of doing deferred unlifting. All this means that while the resulting</span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-comment">-- 'Either' is only handled upon full saturation and any evaluation failure is only</span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-comment">-- registered when the whole builtin application is evaluated, a Haskell exception will</span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-comment">-- occur the same way as with immediate unlifting. It shouldn't matter though, because a</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-comment">-- builtin is not supposed to throw an exception at any stage, that would be a bug</span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-comment">-- regardless of how unlifting is aligned.</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-comment">-- 'pure' signifies that no failure can occur at this point.</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">ToRuntimeDenotationType val (Length args)
-&gt; Either
     KnownTypeError (ToRuntimeDenotationType val (Length args))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(ToRuntimeDenotationType val (Length args)
 -&gt; Either
      KnownTypeError (ToRuntimeDenotationType val (Length args)))
-&gt; (Either KnownTypeError (FoldArgs args res)
    -&gt; ToRuntimeDenotationType val (Length args))
-&gt; Either KnownTypeError (FoldArgs args res)
-&gt; Either
     KnownTypeError (ToRuntimeDenotationType val (Length args))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
ReadKnownM (FoldArgs args res)
-&gt; ToRuntimeDenotationType val (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#toDeferredF"><span class="hs-identifier hs-var">toDeferredF</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040092"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040091"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040090"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><span class="annottext">(Either KnownTypeError (FoldArgs args res)
 -&gt; Either
      KnownTypeError (ToRuntimeDenotationType val (Length args)))
-&gt; Either KnownTypeError (FoldArgs args res)
-&gt; Either
     KnownTypeError (ToRuntimeDenotationType val (Length args))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">ReadKnownM (FoldArgs (arg : args) res)
Either KnownTypeError (arg -&gt; FoldArgs args res)
</span><a href="#local-6989586621681039858"><span class="hs-identifier hs-var">getF</span></a></span><span> </span><span class="annot"><span class="annottext">Either KnownTypeError (arg -&gt; FoldArgs args res)
-&gt; Either KnownTypeError arg
-&gt; Either KnownTypeError (FoldArgs args res)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">val -&gt; Either KnownTypeError arg
forall (uni :: * -&gt; *) val a.
ReadKnownIn uni val a =&gt;
val -&gt; ReadKnownM a
</span><a href="PlutusCore.Builtin.KnownType.html#readKnown"><span class="hs-identifier hs-var">readKnown</span></a></span><span> </span><span class="annot"><span class="annottext">val
</span><a href="#local-6989586621681039857"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toDeferredF"><span class="hs-pragma hs-type">toDeferredF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | A class that allows us to derive a polytype for a builtin.</span><span>
</span><span id="line-203"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownMonotype"><span class="hs-identifier hs-type">KnownMonotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040059"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040058"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040057"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="KnownPolytype"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownPolytype"><span class="hs-identifier hs-var">KnownPolytype</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681040060"><span class="annot"><a href="#local-6989586621681040060"><span class="hs-identifier hs-type">binds</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/12m626qdhg61qnq44614xjh4avrzhzw4-some-lib-some-1.0.3-haddock-doc/share/doc/some/html/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Polymorphism.html#TyNameRep"><span class="hs-identifier hs-type">TyNameRep</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681040059"><span class="annot"><a href="#local-6989586621681040059"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span id="local-6989586621681040058"><span class="annot"><a href="#local-6989586621681040058"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621681040057"><span class="annot"><a href="#local-6989586621681040057"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>    </span><span id="knownPolytype"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#knownPolytype"><span class="hs-identifier hs-type">knownPolytype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.TypeScheme.html#TypeScheme"><span class="hs-identifier hs-type">TypeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040059"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040058"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040057"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span id="knownPolyruntime"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#knownPolyruntime"><span class="hs-identifier hs-type">knownPolyruntime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040058"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Once we've run out of type-level arguments, we start handling term-level ones.</span><span>
</span><span id="line-208"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681040050"><span id="local-6989586621681040051"><span id="local-6989586621681040052"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownMonotype"><span class="hs-identifier hs-type">KnownMonotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040052"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040051"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040050"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownPolytype"><span class="hs-identifier hs-type">KnownPolytype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681040052"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040051"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040050"><span class="hs-identifier hs-type">res</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621681039844"><span class="annot"><span class="annottext">knownPolytype :: TypeScheme val args res
</span><a href="#local-6989586621681039844"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownPolytype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeScheme val args res
forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
TypeScheme val args res
</span><a href="PlutusCore.Builtin.Meaning.html#knownMonotype"><span class="hs-identifier hs-var">knownMonotype</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621681039842"><span class="annot"><span class="annottext">knownPolyruntime :: RuntimeScheme (Length args)
</span><a href="#local-6989586621681039842"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownPolyruntime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
RuntimeScheme (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#knownMonoruntime"><span class="hs-identifier hs-var">knownMonoruntime</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040052"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040051"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040050"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Here we unpack an existentially packed @kind@ and constrain it afterwards!</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- So promoted existentials are true sigmas! If we were at the term level, we'd have to pack</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- @kind@ along with the @KnownKind kind@ constraint, otherwise when we unpack the existential,</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- all information is lost and we can't do anything with @kind@.</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Every type-level argument becomes a 'TypeSchemeAll'.</span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681040032"><span id="local-6989586621681040033"><span id="local-6989586621681040034"><span id="local-6989586621681040035"><span id="local-6989586621681040036"><span id="local-6989586621681040037"><span id="local-6989586621681040038"><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">KnownSymbol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040038"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">KnownNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040037"><span class="hs-identifier hs-type">uniq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownKind.html#KnownKind"><span class="hs-identifier hs-type">KnownKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040036"><span class="hs-identifier hs-type">kind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownPolytype"><span class="hs-identifier hs-type">KnownPolytype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040035"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040034"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040033"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040032"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-218"></span><span>            </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownPolytype"><span class="hs-identifier hs-type">KnownPolytype</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/12m626qdhg61qnq44614xjh4avrzhzw4-some-lib-some-1.0.3-haddock-doc/share/doc/some/html/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Polymorphism.html#TyNameRep"><span class="hs-identifier hs-type">TyNameRep</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040036"><span class="hs-identifier hs-type">kind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040038"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040037"><span class="hs-identifier hs-type">uniq</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621681040035"><span class="hs-identifier hs-type">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681040034"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040033"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040032"><span class="hs-identifier hs-type">res</span></a></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621681039827"><span class="annot"><span class="annottext">knownPolytype :: TypeScheme val args res
</span><a href="#local-6989586621681039827"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownPolytype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (text :: Symbol) (uniq :: Nat) kind val (args :: [*]) res.
(KnownSymbol text, KnownNat uniq, KnownKind kind) =&gt;
Proxy '(text, uniq, kind)
-&gt; TypeScheme val args res -&gt; TypeScheme val args res
</span><a href="PlutusCore.Builtin.TypeScheme.html#TypeSchemeAll"><span class="hs-identifier hs-var">TypeSchemeAll</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040038"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040037"><span class="hs-identifier hs-type">uniq</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040036"><span class="hs-identifier hs-type">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy '(name, uniq, kind)
forall {k} (t :: k). Proxy t
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeScheme val args res -&gt; TypeScheme val args res)
-&gt; TypeScheme val args res -&gt; TypeScheme val args res
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (binds :: [Some TyNameRep]) val (args :: [*]) res.
KnownPolytype binds val args res =&gt;
TypeScheme val args res
</span><a href="PlutusCore.Builtin.Meaning.html#knownPolytype"><span class="hs-identifier hs-var">knownPolytype</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040035"><span class="hs-identifier hs-type">binds</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621681039823"><span class="annot"><span class="annottext">knownPolyruntime :: RuntimeScheme (Length args)
</span><a href="#local-6989586621681039823"><span class="hs-identifier hs-var hs-var hs-var hs-var">knownPolyruntime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme (Length args) -&gt; RuntimeScheme (Length args)
forall (n :: Peano). RuntimeScheme n -&gt; RuntimeScheme n
</span><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeAll"><span class="hs-identifier hs-var">RuntimeSchemeAll</span></a></span><span> </span><span class="annot"><span class="annottext">(RuntimeScheme (Length args) -&gt; RuntimeScheme (Length args))
-&gt; RuntimeScheme (Length args) -&gt; RuntimeScheme (Length args)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (binds :: [Some TyNameRep]) val (args :: [*]) res.
KnownPolytype binds val args res =&gt;
RuntimeScheme (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#knownPolyruntime"><span class="hs-identifier hs-var">knownPolyruntime</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040035"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040034"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040033"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040032"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | Ensure a built-in function is not nullary and throw a nice error otherwise.</span><span>
</span><span id="line-223"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ThrowOnBothEmpty"><span class="hs-identifier hs-type">ThrowOnBothEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/12m626qdhg61qnq44614xjh4avrzhzw4-some-lib-some-1.0.3-haddock-doc/share/doc/some/html/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Polymorphism.html#TyNameRep"><span class="hs-identifier hs-type">TyNameRep</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">GHC.Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">GHC.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">GHC.Constraint</span></a></span><span>
</span><span id="line-224"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ThrowOnBothEmpty"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ThrowOnBothEmpty"><span class="hs-identifier hs-var">ThrowOnBothEmpty</span></a></span></span><span> </span><span id="local-6989586621681039821"><span class="annot"><a href="#local-6989586621681039821"><span class="hs-identifier hs-type">binds</span></a></span></span><span> </span><span id="local-6989586621681039820"><span class="annot"><a href="#local-6989586621681039820"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621681039819"><span class="annot"><a href="#local-6989586621681039819"><span class="hs-identifier hs-type">isBuiltin</span></a></span></span><span> </span><span id="local-6989586621681039818"><span class="annot"><a href="#local-6989586621681039818"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="ThrowOnBothEmpty"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ThrowOnBothEmpty"><span class="hs-identifier hs-var">ThrowOnBothEmpty</span></a></span></span><span> </span><span id="local-6989586621681039817"><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039817"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">TypeError</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;A built-in function must take at least one type or term argument&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#8216;&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">ShowType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&#8217; is a built-in type&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; so you can embed any of its values as a constant&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span>
</span><span id="line-230"></span><span>            </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;If you still want a built-in function, add a dummy &#8216;()&#8217; argument&quot;</span></span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span id="ThrowOnBothEmpty"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ThrowOnBothEmpty"><span class="hs-identifier hs-var">ThrowOnBothEmpty</span></a></span></span><span> </span><span id="local-6989586621681039816"><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">False</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039816"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">TypeError</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-234"></span><span>            </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;A built-in function must take at least one type or term argument&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:$$:</span><span>
</span><span id="line-235"></span><span>            </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;To fix this error add a dummy &#8216;()&#8217; argument&quot;</span></span><span>
</span><span id="line-236"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>    </span><span id="ThrowOnBothEmpty"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ThrowOnBothEmpty"><span class="hs-identifier hs-var">ThrowOnBothEmpty</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | A function turned into a type class with exactly one fully general instance.</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- We can't package up the constraints of 'makeBuiltinMeaning' (see the instance) into a type or</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- class synonym, because they contain a bunch of variables defined by @~@ or determined via</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- functional dependencies and neither class nor type definitions can handle that</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- (see https://gitlab.haskell.org/ghc/ghc/-/issues/7100). Inlining three lines of constraints</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- whenever we need to call 'makeBuiltinMeaning' over a non-concrete type is a bad option and this</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- abstraction is free anyway, hence its existence.</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- The @a@ type variable goes first, because @makeBuiltinMeaning \@A@ is a common pattern.</span><span>
</span><span id="line-248"></span><span class="hs-keyword">class</span><span> </span><span id="MakeBuiltinMeaning"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#MakeBuiltinMeaning"><span class="hs-identifier hs-var">MakeBuiltinMeaning</span></a></span></span><span> </span><span id="local-6989586621681040009"><span class="annot"><a href="#local-6989586621681040009"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621681040008"><span class="annot"><a href="#local-6989586621681040008"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">-- See Note [Automatic derivation of type schemes]</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">-- | Construct the meaning for a built-in function by automatically deriving its</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">-- 'TypeScheme', given</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-comment">-- 1. the denotation of the builtin</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-comment">-- 2. an uninstantiated costing function</span><span>
</span><span id="line-255"></span><span>    </span><span id="makeBuiltinMeaning"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#makeBuiltinMeaning"><span class="hs-identifier hs-type">makeBuiltinMeaning</span></a></span></span><span>
</span><span id="line-256"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681040022"><span class="annot"><a href="#local-6989586621681040009"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681040022"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-type">ToCostingType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#Length"><span class="hs-identifier hs-type">Length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#GetArgs"><span class="hs-identifier hs-type">GetArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-type">BuiltinMeaning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040008"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040022"><span class="hs-identifier hs-type">cost</span></a></span></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-258"></span><span>        </span><span id="local-6989586621681040002"><span id="local-6989586621681040003"><span id="local-6989586621681040004"><span id="local-6989586621681040005"><span id="local-6989586621681040006"><span id="local-6989586621681040007"><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621681040007"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownTypeAst.html#ToBinds"><span class="hs-identifier hs-type">ToBinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#GetArgs"><span class="hs-identifier hs-type">GetArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681040006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#FoldArgs"><span class="hs-identifier hs-type">FoldArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040004"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ThrowOnBothEmpty"><span class="hs-identifier hs-type">ThrowOnBothEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040007"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.KnownTypeAst.html#IsBuiltin"><span class="hs-identifier hs-type">IsBuiltin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681040006"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Elaborate.html#ElaborateFromTo"><span class="hs-identifier hs-type">ElaborateFromTo</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621681040003"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040002"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#KnownPolytype"><span class="hs-identifier hs-type">KnownPolytype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040007"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040002"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040004"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#MakeBuiltinMeaning"><span class="hs-identifier hs-type">MakeBuiltinMeaning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681040002"><span class="hs-identifier hs-type">val</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621681039795"><span class="annot"><span class="annottext">makeBuiltinMeaning :: forall cost.
a
-&gt; (cost -&gt; ToCostingType (Length (GetArgs a)))
-&gt; BuiltinMeaning val cost
</span><a href="#local-6989586621681039795"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeBuiltinMeaning</span></a></span></span><span> </span><span id="local-6989586621681039794"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681039794"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681039793"><span class="annot"><span class="annottext">cost -&gt; ToCostingType (Length (GetArgs a))
</span><a href="#local-6989586621681039793"><span class="hs-identifier hs-var">toExF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">TypeScheme val args res
-&gt; FoldArgs args res
-&gt; BuiltinRuntimeOptions (Length args) val cost
-&gt; BuiltinMeaning val cost
forall val cost (args :: [*]) res.
TypeScheme val args res
-&gt; FoldArgs args res
-&gt; BuiltinRuntimeOptions (Length args) val cost
-&gt; BuiltinMeaning val cost
</span><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-var">BuiltinMeaning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (binds :: [Some TyNameRep]) val (args :: [*]) res.
KnownPolytype binds val args res =&gt;
TypeScheme val args res
</span><a href="PlutusCore.Builtin.Meaning.html#knownPolytype"><span class="hs-identifier hs-var">knownPolytype</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040007"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040002"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040004"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
FoldArgs args res
</span><a href="#local-6989586621681039794"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinRuntimeOptions (Length args) val cost
 -&gt; BuiltinMeaning val cost)
-&gt; BuiltinRuntimeOptions (Length args) val cost
-&gt; BuiltinMeaning val cost
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-264"></span><span>            </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntimeOptions"><span class="hs-identifier hs-type">BuiltinRuntimeOptions</span></a></span><span>
</span><span id="line-265"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_broRuntimeScheme :: RuntimeScheme (Length args)
</span><a href="#local-6989586621681039791"><span class="hs-identifier hs-var">_broRuntimeScheme</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (binds :: [Some TyNameRep]) val (args :: [*]) res.
KnownPolytype binds val args res =&gt;
RuntimeScheme (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#knownPolyruntime"><span class="hs-identifier hs-var">knownPolyruntime</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040007"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040002"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040004"><span class="hs-identifier hs-type">res</span></a></span><span>
</span><span id="line-266"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_broImmediateF :: ToRuntimeDenotationType val (Length args)
</span><a href="#local-6989586621681039790"><span class="hs-identifier hs-var">_broImmediateF</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
FoldArgs args res -&gt; ToRuntimeDenotationType val (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#toImmediateF"><span class="hs-identifier hs-var">toImmediateF</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040002"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040004"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><span class="annottext">a
FoldArgs args res
</span><a href="#local-6989586621681039794"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-267"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_broDeferredF :: ToRuntimeDenotationType val (Length args)
</span><a href="#local-6989586621681039789"><span class="hs-identifier hs-var">_broDeferredF</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall val (args :: [*]) res.
KnownMonotype val args res =&gt;
ReadKnownM (FoldArgs args res)
-&gt; ToRuntimeDenotationType val (Length args)
</span><a href="PlutusCore.Builtin.Meaning.html#toDeferredF"><span class="hs-identifier hs-var">toDeferredF</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040002"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040005"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681040004"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><span class="annottext">(ReadKnownM (FoldArgs args res)
 -&gt; ToRuntimeDenotationType val (Length args))
-&gt; ReadKnownM (FoldArgs args res)
-&gt; ToRuntimeDenotationType val (Length args)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either KnownTypeError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681039794"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-268"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_broToExF :: cost -&gt; ToCostingType (Length args)
</span><a href="#local-6989586621681039788"><span class="hs-identifier hs-var">_broToExF</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">cost -&gt; ToCostingType (Length args)
cost -&gt; ToCostingType (Length (GetArgs a))
</span><a href="#local-6989586621681039793"><span class="hs-identifier hs-var">toExF</span></a></span><span>
</span><span id="line-269"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#makeBuiltinMeaning"><span class="hs-pragma hs-type">makeBuiltinMeaning</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Convert a 'BuiltinMeaning' to a 'BuiltinRuntime' given an 'UnliftingMode' and a cost model.</span><span>
</span><span id="line-273"></span><span id="local-6989586621681039994"><span id="local-6989586621681039995"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toBuiltinRuntime"><span class="hs-identifier hs-type">toBuiltinRuntime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#UnliftingMode"><span class="hs-identifier hs-type">UnliftingMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681039995"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-type">BuiltinMeaning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039994"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039995"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039994"><span class="hs-identifier hs-type">val</span></a></span></span></span><span>
</span><span id="line-274"></span><span id="toBuiltinRuntime"><span class="annot"><span class="annottext">toBuiltinRuntime :: forall cost val.
UnliftingMode
-&gt; cost -&gt; BuiltinMeaning val cost -&gt; BuiltinRuntime val
</span><a href="PlutusCore.Builtin.Meaning.html#toBuiltinRuntime"><span class="hs-identifier hs-var hs-var">toBuiltinRuntime</span></a></span></span><span> </span><span id="local-6989586621681039786"><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621681039786"><span class="hs-identifier hs-var">unlMode</span></a></span></span><span> </span><span id="local-6989586621681039785"><span class="annot"><span class="annottext">cost
</span><a href="#local-6989586621681039785"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinMeaning"><span class="hs-identifier hs-type">BuiltinMeaning</span></a></span><span> </span><span class="annot"><span class="annottext">TypeScheme val args res
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FoldArgs args res
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681039784"><span class="annot"><span class="annottext">BuiltinRuntimeOptions (Length args) val cost
</span><a href="#local-6989586621681039784"><span class="hs-identifier hs-var">runtimeOpts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">UnliftingMode
-&gt; cost
-&gt; BuiltinRuntimeOptions (Length args) val cost
-&gt; BuiltinRuntime val
forall cost (n :: Peano) val.
UnliftingMode
-&gt; cost -&gt; BuiltinRuntimeOptions n val cost -&gt; BuiltinRuntime val
</span><a href="PlutusCore.Builtin.Runtime.html#fromBuiltinRuntimeOptions"><span class="hs-identifier hs-var">fromBuiltinRuntimeOptions</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621681039786"><span class="hs-identifier hs-var">unlMode</span></a></span><span> </span><span class="annot"><span class="annottext">cost
</span><a href="#local-6989586621681039785"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinRuntimeOptions (Length args) val cost
</span><a href="#local-6989586621681039784"><span class="hs-identifier hs-var">runtimeOpts</span></a></span><span>
</span><span id="line-276"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toBuiltinRuntime"><span class="hs-pragma hs-type">toBuiltinRuntime</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- See Note [Inlining meanings of builtins].</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Calculate runtime info for all built-in functions given denotations of builtins,</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- an 'UnliftingMode' and a cost model.</span><span>
</span><span id="line-281"></span><span id="local-6989586621681039982"><span id="local-6989586621681039983"><span id="local-6989586621681039984"><span id="local-6989586621681039985"><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toBuiltinsRuntime"><span class="hs-identifier hs-type">toBuiltinsRuntime</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681039985"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#CostingPart"><span class="hs-identifier hs-type">CostingPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039984"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039983"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#ToBuiltinMeaning"><span class="hs-identifier hs-type">ToBuiltinMeaning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039984"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039983"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#HasMeaningIn"><span class="hs-identifier hs-type">HasMeaningIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039984"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039982"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#UnliftingMode"><span class="hs-identifier hs-type">UnliftingMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681039985"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-type">BuiltinsRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039983"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681039982"><span class="hs-identifier hs-type">val</span></a></span></span></span></span></span><span>
</span><span id="line-284"></span><span id="toBuiltinsRuntime"><span class="annot"><span class="annottext">toBuiltinsRuntime :: forall cost (uni :: * -&gt; *) fun val.
(cost ~ CostingPart uni fun, ToBuiltinMeaning uni fun,
 HasMeaningIn uni val) =&gt;
UnliftingMode -&gt; cost -&gt; BuiltinsRuntime fun val
</span><a href="PlutusCore.Builtin.Meaning.html#toBuiltinsRuntime"><span class="hs-identifier hs-var hs-var">toBuiltinsRuntime</span></a></span></span><span> </span><span id="local-6989586621681039758"><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621681039758"><span class="hs-identifier hs-var">unlMode</span></a></span></span><span> </span><span id="local-6989586621681039757"><span class="annot"><span class="annottext">cost
</span><a href="#local-6989586621681039757"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">Array fun (BuiltinRuntime val) -&gt; BuiltinsRuntime fun val
forall fun val.
Array fun (BuiltinRuntime val) -&gt; BuiltinsRuntime fun val
</span><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-var">BuiltinsRuntime</span></a></span><span> </span><span class="annot"><span class="annottext">(Array fun (BuiltinRuntime val) -&gt; BuiltinsRuntime fun val)
-&gt; ((fun -&gt; BuiltinRuntime val) -&gt; Array fun (BuiltinRuntime val))
-&gt; (fun -&gt; BuiltinRuntime val)
-&gt; BuiltinsRuntime fun val
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(fun -&gt; BuiltinRuntime val) -&gt; Array fun (BuiltinRuntime val)
forall i a. (Bounded i, Enum i, Ix i) =&gt; (i -&gt; a) -&gt; Array i a
</span><a href="PlutusPrelude.html#tabulateArray"><span class="hs-identifier hs-var">tabulateArray</span></a></span><span> </span><span class="annot"><span class="annottext">((fun -&gt; BuiltinRuntime val) -&gt; BuiltinsRuntime fun val)
-&gt; (fun -&gt; BuiltinRuntime val) -&gt; BuiltinsRuntime fun val
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode
-&gt; cost -&gt; BuiltinMeaning val cost -&gt; BuiltinRuntime val
forall cost val.
UnliftingMode
-&gt; cost -&gt; BuiltinMeaning val cost -&gt; BuiltinRuntime val
</span><a href="PlutusCore.Builtin.Meaning.html#toBuiltinRuntime"><span class="hs-identifier hs-var">toBuiltinRuntime</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621681039758"><span class="hs-identifier hs-var">unlMode</span></a></span><span> </span><span class="annot"><span class="annottext">cost
</span><a href="#local-6989586621681039757"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinMeaning val cost -&gt; BuiltinRuntime val)
-&gt; (fun -&gt; BuiltinMeaning val cost) -&gt; fun -&gt; BuiltinRuntime val
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(fun -&gt; BuiltinMeaning val cost) -&gt; fun -&gt; BuiltinMeaning val cost
forall a. a -&gt; a
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">inline</span></a></span><span> </span><span class="annot"><span class="annottext">fun -&gt; BuiltinMeaning val cost
forall (uni :: * -&gt; *) fun val.
(ToBuiltinMeaning uni fun, HasMeaningIn uni val) =&gt;
fun -&gt; BuiltinMeaning val (CostingPart uni fun)
</span><a href="PlutusCore.Builtin.Meaning.html#toBuiltinMeaning"><span class="hs-identifier hs-var">toBuiltinMeaning</span></a></span><span>
</span><span id="line-286"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#toBuiltinsRuntime"><span class="hs-pragma hs-type">toBuiltinsRuntime</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-287"></span></pre></body></html>