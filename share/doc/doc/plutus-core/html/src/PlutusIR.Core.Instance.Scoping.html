<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans       #-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusIR.Core.Instance.Scoping</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html"><span class="hs-identifier">PlutusIR.Core.Type</span></a></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html"><span class="hs-identifier">PlutusCore.Check.Scoping</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.MkPlc.html"><span class="hs-identifier">PlutusCore.MkPlc</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html"><span class="hs-identifier">PlutusCore.Quote</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator">(&lt;|)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Traversable</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100837"><span id="local-6989586621681100838"><span id="local-6989586621681100839"><span id="local-6989586621681100840"><span class="annot"><a href="#local-6989586621681100840"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100840"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100839"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100838"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100837"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>    </span><span id="local-6989586621681100533"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; Term tyname name uni fun NameAnn
-&gt; Term tyname name uni fun NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100531"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100531"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100530"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100530"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span id="local-6989586621681100529"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100529"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100529"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100531"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100530"><span class="hs-identifier hs-var">tyname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100530"><span class="hs-identifier hs-var">tyname</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100816"><span id="local-6989586621681100817"><span id="local-6989586621681100818"><span id="local-6989586621681100819"><span class="annot"><a href="#local-6989586621681100819"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100818"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100819"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100817"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100816"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>    </span><span id="local-6989586621681100519"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Name
-&gt; Term tyname name uni fun NameAnn
-&gt; Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100519"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100518"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100518"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100517"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100517"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681100516"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100516"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100516"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100518"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100517"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100517"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100809"><span id="local-6989586621681100810"><span id="local-6989586621681100811"><span class="annot"><a href="#local-6989586621681100811"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100811"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100810"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100809"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>    </span><span id="local-6989586621681100505"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; VarDecl tyname name uni NameAnn
-&gt; VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681100505"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100504"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100504"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100503"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100503"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span id="local-6989586621681100501"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100501"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100500"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100500"><span class="hs-identifier hs-var">varName</span></a></span></span><span> </span><span id="local-6989586621681100499"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681100499"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100501"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100500"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100504"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100503"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681100499"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Scoping for data types is hard, so we employ some extra paranoia and reference the provided</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- 'TyName' in the type of every single constructor, and also apply the final head to that 'TyName'.</span><span>
</span><span id="line-33"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100795"><span id="local-6989586621681100796"><span id="local-6989586621681100797"><span class="annot"><a href="#local-6989586621681100797"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100797"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100796"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100795"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>    </span><span id="local-6989586621681100491"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; Datatype tyname name uni NameAnn
-&gt; Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681100491"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100490"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100490"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100489"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100489"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span id="local-6989586621681100487"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100487"><span class="hs-identifier hs-var">dataAnn</span></a></span></span><span> </span><span id="local-6989586621681100486"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681100486"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span id="local-6989586621681100485"><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681100485"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681100484"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100484"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span id="local-6989586621681100483"><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681100483"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) a.
a
-&gt; TyVarDecl tyname a
-&gt; [TyVarDecl tyname a]
-&gt; name
-&gt; [VarDecl tyname name uni a]
-&gt; Datatype tyname name uni a
</span><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-var">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100487"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681100486"><span class="hs-identifier hs-var">dataDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681100485"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100484"><span class="hs-identifier hs-var">matchName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl TyName name uni NameAnn -&gt; VarDecl TyName name uni NameAnn
</span><a href="#local-6989586621681100482"><span class="hs-identifier hs-var">goConstr</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681100483"><span class="hs-identifier hs-var">constrs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>            </span><span id="local-6989586621681100481"><span class="annot"><span class="annottext">tyVar :: Type TyName uni NameAnn
</span><a href="#local-6989586621681100481"><span class="hs-identifier hs-var hs-var">tyVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100490"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100489"><span class="hs-identifier hs-var">tyname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100489"><span class="hs-identifier hs-var">tyname</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>            </span><span id="local-6989586621681100482"><span class="annot"><span class="annottext">goConstr :: VarDecl TyName name uni NameAnn -&gt; VarDecl TyName name uni NameAnn
</span><a href="#local-6989586621681100482"><span class="hs-identifier hs-var hs-var">goConstr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span id="local-6989586621681100480"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100480"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100479"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100479"><span class="hs-identifier hs-var">constrName</span></a></span></span><span> </span><span id="local-6989586621681100478"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100478"><span class="hs-identifier hs-var">constrTy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100480"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100479"><span class="hs-identifier hs-var">constrName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100477"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100478"><span class="hs-identifier hs-var">constrTy</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>            </span><span id="local-6989586621681100477"><span class="annot"><span class="annottext">goSpine :: Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100477"><span class="hs-identifier hs-var hs-var">goSpine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-type">TyForall</span></a></span><span> </span><span id="local-6989586621681100475"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100475"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100474"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100474"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681100473"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681100473"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681100472"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100472"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; tyname -&gt; Kind ann -&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-var">TyForall</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100475"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100474"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681100473"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100477"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100472"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-41"></span><span>            </span><span class="annot"><a href="#local-6989586621681100477"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-type">TyFun</span></a></span><span> </span><span id="local-6989586621681100470"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100470"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100469"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100469"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681100468"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100468"><span class="hs-identifier hs-var">cod</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100470"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100469"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100477"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100468"><span class="hs-identifier hs-var">cod</span></a></span><span>
</span><span id="line-42"></span><span>            </span><span class="annot"><a href="#local-6989586621681100477"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span id="local-6989586621681100467"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100467"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100481"><span class="hs-identifier hs-var">tyVar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100466"><span class="hs-identifier hs-var">goResult</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100467"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>            </span><span id="local-6989586621681100466"><span class="annot"><span class="annottext">goResult :: Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100466"><span class="hs-identifier hs-var hs-var">goResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-type">TyApp</span></a></span><span> </span><span id="local-6989586621681100464"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100464"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100463"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100463"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681100462"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100462"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-var">TyApp</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100464"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type TyName uni NameAnn -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100466"><span class="hs-identifier hs-var">goResult</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100463"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100462"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-45"></span><span>            </span><span class="annot"><a href="#local-6989586621681100466"><span class="hs-identifier hs-var">goResult</span></a></span><span> </span><span id="local-6989586621681100461"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100461"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-var">TyApp</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100461"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100481"><span class="hs-identifier hs-var">tyVar</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100778"><span id="local-6989586621681100779"><span id="local-6989586621681100780"><span id="local-6989586621681100781"><span class="annot"><a href="#local-6989586621681100781"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100781"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100780"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100779"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100778"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621681100447"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyName
-&gt; Binding tyname name uni fun NameAnn
-&gt; Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681100447"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100446"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100446"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100445"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100445"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span id="local-6989586621681100443"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100443"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100442"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681100442"><span class="hs-identifier hs-var">strictness</span></a></span></span><span> </span><span id="local-6989586621681100441"><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681100441"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span id="local-6989586621681100440"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100440"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100443"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681100442"><span class="hs-identifier hs-var">strictness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100446"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100445"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681100441"><span class="hs-identifier hs-var">varDecl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100446"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100445"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100440"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681100435"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100435"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100434"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100434"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span id="local-6989586621681100432"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100432"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100431"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681100431"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span id="local-6989586621681100430"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681100430"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-var">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100432"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681100431"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100435"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100434"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681100430"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681100427"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100427"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100426"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100426"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span id="local-6989586621681100424"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100424"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100423"><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681100423"><span class="hs-identifier hs-var">datatype</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Datatype tyname name uni a -&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-var">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100424"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100427"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100426"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681100423"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Unlike other 'Reference' instances this one does not guarantee that the name will actually be</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- referenced, but it's too convenient to have this instance to give up on it, without it would be</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- awkward to express \&quot;reference this binding in this thing\&quot;.</span><span>
</span><span id="line-58"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100760"><span id="local-6989586621681100761"><span id="local-6989586621681100762"><span id="local-6989586621681100763"><span class="annot"><a href="#local-6989586621681100763"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100762"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100763"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100761"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100760"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621681100413"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Name
-&gt; Binding tyname name uni fun NameAnn
-&gt; Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681100413"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100412"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100412"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621681100411"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100411"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span id="local-6989586621681100410"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100410"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681100409"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681100409"><span class="hs-identifier hs-var">strictness</span></a></span></span><span> </span><span id="local-6989586621681100408"><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681100408"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span id="local-6989586621681100407"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100407"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681100410"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681100409"><span class="hs-identifier hs-var">strictness</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681100408"><span class="hs-identifier hs-var">varDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100412"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100411"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681100407"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100404"><span class="annot"><span class="annottext">typeBind :: Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681100404"><span class="hs-identifier hs-var">typeBind</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681100404"><span class="hs-identifier hs-var">typeBind</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100403"><span class="annot"><span class="annottext">datatypeBind :: Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681100403"><span class="hs-identifier hs-var">datatypeBind</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding tyname name uni fun NameAnn
</span><a href="#local-6989586621681100403"><span class="hs-identifier hs-var">datatypeBind</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100753"><span id="local-6989586621681100754"><span id="local-6989586621681100755"><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100755"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100754"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100755"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100753"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100754"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621681100398"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; TyVarDecl tyname ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681100398"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100397"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100397"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100397"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname ann. TyVarDecl tyname ann -&gt; tyname
</span><a href="PlutusCore.Core.Type.html#_tyVarDeclName"><span class="hs-identifier hs-var">_tyVarDeclName</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100737"><span id="local-6989586621681100738"><span id="local-6989586621681100739"><span id="local-6989586621681100740"><span id="local-6989586621681100741"><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100741"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100740"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100739"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100741"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100738"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100737"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100740"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621681100388"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; VarDecl tyname name uni ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681100388"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100387"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100387"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100387"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
VarDecl tyname name uni ann -&gt; name
</span><a href="PlutusCore.Core.Type.html#_varDeclName"><span class="hs-identifier hs-var">_varDeclName</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100726"><span id="local-6989586621681100727"><span id="local-6989586621681100728"><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100728"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100728"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100727"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100726"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100728"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621681100373"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Datatype TyName Name uni ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681100373"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100372"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100372"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100371"><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681100371"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span id="local-6989586621681100370"><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681100370"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681100369"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100369"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span id="local-6989586621681100368"><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100368"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100372"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681100371"><span class="hs-identifier hs-var">dataDecl</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-comment">-- Parameters of a data type are not visible outside of the data type no matter what.</span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceOutOfScope"><span class="hs-identifier hs-var">referenceOutOfScope</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681100370"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100372"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100369"><span class="hs-identifier hs-var">matchName</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100372"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100368"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100711"><span id="local-6989586621681100712"><span id="local-6989586621681100713"><span id="local-6989586621681100714"><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100714"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100714"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100713"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100712"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100711"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681100714"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621681100353"><span class="annot"><span class="annottext">referenceVia :: (forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Binding TyName Name uni fun ann -&gt; t NameAnn -&gt; t NameAnn
</span><a href="#local-6989586621681100353"><span class="hs-identifier hs-var hs-var hs-var hs-var">referenceVia</span></a></span></span><span> </span><span id="local-6989586621681100352"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100352"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100351"><span class="annot"><span class="annottext">VarDecl TyName Name uni ann
</span><a href="#local-6989586621681100351"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100352"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl TyName Name uni ann
</span><a href="#local-6989586621681100351"><span class="hs-identifier hs-var">varDecl</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681100348"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100348"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100347"><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681100347"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100348"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681100347"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span id="local-6989586621681100344"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100344"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100343"><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681100343"><span class="hs-identifier hs-var">datatype</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100344"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681100343"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Establish scoping for each of the parameters of a datatype by only annotating every parameter</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- with 'introduceBound'.</span><span>
</span><span id="line-85"></span><span id="local-6989586621681100707"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingParams"><span class="hs-identifier hs-type">establishScopingParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100707"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-86"></span><span id="establishScopingParams"><span class="annot"><span class="annottext">establishScopingParams :: forall ann.
[TyVarDecl TyName ann] -&gt; Quote [TyVarDecl TyName NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingParams"><span class="hs-identifier hs-var hs-var">establishScopingParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100320"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100320"><span class="hs-identifier hs-var">paramNameDup</span></a></span></span><span> </span><span id="local-6989586621681100319"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100319"><span class="hs-identifier hs-var">paramKind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>        </span><span id="local-6989586621681100318"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100318"><span class="hs-identifier hs-var">paramName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100320"><span class="hs-identifier hs-var">paramNameDup</span></a></span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">forall tyname ann.
ann -&gt; tyname -&gt; Kind ann -&gt; TyVarDecl tyname ann
</span><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-var">TyVarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100318"><span class="hs-identifier hs-var">paramName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100318"><span class="hs-identifier hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100319"><span class="hs-identifier hs-var">paramKind</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- See Note [Weird IR data types].</span><span>
</span><span id="line-92"></span><span class="hs-comment">{- | Establish scoping for the type of a constructor. The updated constructor expects an argument
of the \&quot;the data type applied to all its parameters\&quot; type (that argument is the last one) and
always returns that exact type as a result. For example, this functions turns the following
generated type of constructor

    integer -&gt; a -&gt; &lt;a_non_-&gt;_type&gt;

into

    integer -&gt; a -&gt; D a b -&gt; D a b

assuming the constructor is supposed to construct a data type @D@ parameterized by two parameters
@a@ and @b@. Note that @&lt;a_non_-&gt;_type&gt;@ can be anything as the generator is allowed to generate
mess such as a constructor not actually constructing a value of the data type.

Whether the name of the data type is referenced as in-scope or out-of-scope one in the types of
arguments of constructors is controlled by the first argument, which ultimately depends on the
recursivity of the data type.
-}</span><span>
</span><span id="line-111"></span><span id="local-6989586621681100683"><span id="local-6989586621681100684"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrTy"><span class="hs-identifier hs-type">establishScopingConstrTy</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100684"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100683"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100684"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-117"></span><span id="establishScopingConstrTy"><span class="annot"><span class="annottext">establishScopingConstrTy :: forall (uni :: * -&gt; *) ann.
(TyName -&gt; NameAnn)
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; Type TyName uni ann
-&gt; Quote (Type TyName uni NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrTy"><span class="hs-identifier hs-var hs-var">establishScopingConstrTy</span></a></span></span><span> </span><span id="local-6989586621681100294"><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681100294"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span id="local-6989586621681100293"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100293"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621681100292"><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681100292"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681100291"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621681100290"><span class="annot"><span class="annottext">toDataAppliedToParams :: (TyName -&gt; NameAnn) -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100290"><span class="hs-identifier hs-var hs-var">toDataAppliedToParams</span></a></span></span><span> </span><span id="local-6989586621681100289"><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681100289"><span class="hs-identifier hs-var">reg</span></a></span></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann tyname (uni :: * -&gt; *).
ann
-&gt; Type tyname uni ann
-&gt; [Type tyname uni ann]
-&gt; Type tyname uni ann
</span><a href="PlutusCore.MkPlc.html#mkIterTyApp"><span class="hs-identifier hs-var">mkIterTyApp</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681100289"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100293"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100293"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100287"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100287"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100287"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100287"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681100292"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621681100291"><span class="annot"><span class="annottext">goSpine :: Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681100291"><span class="hs-identifier hs-var hs-var">goSpine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-type">TyForall</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100285"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100285"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681100284"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100284"><span class="hs-identifier hs-var">kindDup</span></a></span></span><span> </span><span id="local-6989586621681100283"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100283"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-comment">-- Similar to 'establishScopingBinder', but uses 'TyFun' rather than whatever 'registerVia'</span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-comment">-- uses in order not to break the invariants described in Note [Weird IR data types].</span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-comment">-- Also calls 'goSpine' recursively rather than 'establishScoping'.</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621681100282"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100282"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100285"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621681100281"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681100281"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100284"><span class="hs-identifier hs-var">kindDup</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerOutOfScope"><span class="hs-identifier hs-var">registerOutOfScope</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100282"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100282"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-129"></span><span>            </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; tyname -&gt; Kind ann -&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-var">TyForall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100282"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100282"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681100281"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-130"></span><span>                </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100282"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100282"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-131"></span><span>                    </span><span class="annot"><span class="annottext">Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681100291"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100283"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621681100291"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-type">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100279"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100279"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681100278"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100278"><span class="hs-identifier hs-var">cod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100279"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann -&gt; QuoteT Identity (Type TyName uni NameAnn)
</span><a href="#local-6989586621681100291"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100278"><span class="hs-identifier hs-var">cod</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="#local-6989586621681100291"><span class="hs-identifier hs-var">goSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyName -&gt; NameAnn) -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100290"><span class="hs-identifier hs-var">toDataAppliedToParams</span></a></span><span> </span><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681100294"><span class="hs-identifier hs-var">regSelf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TyName -&gt; NameAnn) -&gt; Type TyName uni NameAnn
</span><a href="#local-6989586621681100290"><span class="hs-identifier hs-var">toDataAppliedToParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Establish scoping for all constructors of a data type by establishing scoping for each of them</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- individually. If there are no constructors, then a dummy one is added, because we need to</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- maintain the invariant that every binding is referenced as an in-scope one somewhere and the only</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- place where parameters of a data type can be referenced this way is a constructor of that data</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- type.</span><span>
</span><span id="line-141"></span><span id="local-6989586621681100670"><span id="local-6989586621681100671"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrs"><span class="hs-identifier hs-type">establishScopingConstrs</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100671"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100670"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100671"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100670"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-148"></span><span id="establishScopingConstrs"><span class="annot"><span class="annottext">establishScopingConstrs :: forall ann (uni :: * -&gt; *).
(TyName -&gt; NameAnn)
-&gt; ann
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; [VarDecl TyName Name uni ann]
-&gt; Quote [VarDecl TyName Name uni NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrs"><span class="hs-identifier hs-var hs-var">establishScopingConstrs</span></a></span></span><span> </span><span id="local-6989586621681100262"><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681100262"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span id="local-6989586621681100261"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681100261"><span class="hs-identifier hs-var">dataAnn</span></a></span></span><span> </span><span id="local-6989586621681100260"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100260"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621681100259"><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681100259"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681100258"><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100258"><span class="hs-identifier hs-var">constrsPossiblyEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621681100257"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100257"><span class="hs-identifier hs-var">cons0Name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Text -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshName"><span class="hs-identifier hs-var">freshName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cons0&quot;</span></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681100255"><span class="annot"><span class="annottext">cons0 :: VarDecl TyName Name uni ann
</span><a href="#local-6989586621681100255"><span class="hs-identifier hs-var hs-var">cons0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681100261"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100257"><span class="hs-identifier hs-var">cons0Name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681100261"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100260"><span class="hs-identifier hs-var">dataName</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span id="local-6989586621681100254"><span class="annot"><span class="annottext">constrs :: [VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100254"><span class="hs-identifier hs-var hs-var">constrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100258"><span class="hs-identifier hs-var">constrsPossiblyEmpty</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VarDecl TyName Name uni ann
</span><a href="#local-6989586621681100255"><span class="hs-identifier hs-var">cons0</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100258"><span class="hs-identifier hs-var">constrsPossiblyEmpty</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">for</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100254"><span class="hs-identifier hs-var">constrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100251"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100251"><span class="hs-identifier hs-var">constrNameDup</span></a></span></span><span> </span><span id="local-6989586621681100250"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100250"><span class="hs-identifier hs-var">constrTyDup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>        </span><span id="local-6989586621681100249"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100249"><span class="hs-identifier hs-var">constrName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100251"><span class="hs-identifier hs-var">constrNameDup</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span id="local-6989586621681100247"><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100247"><span class="hs-identifier hs-var">constrTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) ann.
(TyName -&gt; NameAnn)
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; Type TyName uni ann
-&gt; Quote (Type TyName uni NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrTy"><span class="hs-identifier hs-var">establishScopingConstrTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyName -&gt; NameAnn
</span><a href="#local-6989586621681100262"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100260"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681100259"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100250"><span class="hs-identifier hs-var">constrTyDup</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100249"><span class="hs-identifier hs-var">constrName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100249"><span class="hs-identifier hs-var">constrName</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni NameAnn
</span><a href="#local-6989586621681100247"><span class="hs-identifier hs-var">constrTy</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Establish scoping of a binding. Each bindings gets referenced in its own body either as an</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- in-scope or out-of-scope one, which is controlled by the first argument and ultimately depends on</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- the recursivity of the binding.</span><span>
</span><span id="line-160"></span><span id="local-6989586621681100656"><span id="local-6989586621681100657"><span id="local-6989586621681100658"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-type">establishScopingBinding</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681100245"><span class="annot"><a href="#local-6989586621681100245"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100245"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100245"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100658"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100657"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100656"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100658"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100657"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-164"></span><span id="establishScopingBinding"><span class="annot"><span class="annottext">establishScopingBinding :: forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Binding TyName Name uni fun ann
-&gt; Quote (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var hs-var">establishScopingBinding</span></a></span></span><span> </span><span id="local-6989586621681100205"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100205"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100204"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681100204"><span class="hs-identifier hs-var">strictness</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100203"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100203"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681100202"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100202"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681100201"><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681100201"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621681100200"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100200"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100203"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621681100199"><span class="annot"><span class="annottext">VarDecl TyName Name uni NameAnn
</span><a href="#local-6989586621681100199"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100200"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100200"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100202"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681100204"><span class="hs-identifier hs-var">strictness</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl TyName Name uni NameAnn
</span><a href="#local-6989586621681100199"><span class="hs-identifier hs-var">varDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100205"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100200"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681100201"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-168"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var">establishScopingBinding</span></a></span><span> </span><span id="local-6989586621681100196"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100196"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100195"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100195"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681100194"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100194"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681100193"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100193"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621681100192"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100192"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100195"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621681100191"><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681100191"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tyname ann.
ann -&gt; tyname -&gt; Kind ann -&gt; TyVarDecl tyname ann
</span><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-var">TyVarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100192"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100192"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100194"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-var">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681100191"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100196"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100192"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681100193"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-172"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var">establishScopingBinding</span></a></span><span> </span><span id="local-6989586621681100188"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100188"><span class="hs-identifier hs-var">regSelf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span id="local-6989586621681100187"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681100187"><span class="hs-identifier hs-var">dataAnn</span></a></span></span><span> </span><span id="local-6989586621681100186"><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681100186"><span class="hs-identifier hs-var">datatypeDup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100185"><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681100185"><span class="hs-identifier hs-var">dataDeclDup</span></a></span></span><span> </span><span id="local-6989586621681100184"><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681100184"><span class="hs-identifier hs-var">paramsDup</span></a></span></span><span> </span><span id="local-6989586621681100183"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100183"><span class="hs-identifier hs-var">matchNameDup</span></a></span></span><span> </span><span id="local-6989586621681100182"><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100182"><span class="hs-identifier hs-var">constrsDup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datatype TyName Name uni ann
</span><a href="#local-6989586621681100186"><span class="hs-identifier hs-var">datatypeDup</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100181"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100181"><span class="hs-identifier hs-var">dataNameDup</span></a></span></span><span> </span><span id="local-6989586621681100180"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100180"><span class="hs-identifier hs-var">dataKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><a href="#local-6989586621681100185"><span class="hs-identifier hs-var">dataDeclDup</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621681100179"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100179"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100181"><span class="hs-identifier hs-var">dataNameDup</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621681100178"><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681100178"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tyname ann.
ann -&gt; tyname -&gt; Kind ann -&gt; TyVarDecl tyname ann
</span><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-var">TyVarDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100179"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100179"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100180"><span class="hs-identifier hs-var">dataKind</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621681100177"><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681100177"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ann.
[TyVarDecl TyName ann] -&gt; Quote [TyVarDecl TyName NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingParams"><span class="hs-identifier hs-var">establishScopingParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><a href="#local-6989586621681100184"><span class="hs-identifier hs-var">paramsDup</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621681100176"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100176"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100183"><span class="hs-identifier hs-var">matchNameDup</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621681100175"><span class="annot"><span class="annottext">[VarDecl TyName Name uni NameAnn]
</span><a href="#local-6989586621681100175"><span class="hs-identifier hs-var">constrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ann (uni :: * -&gt; *).
(TyName -&gt; NameAnn)
-&gt; ann
-&gt; TyName
-&gt; [TyVarDecl TyName NameAnn]
-&gt; [VarDecl TyName Name uni ann]
-&gt; Quote [VarDecl TyName Name uni NameAnn]
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingConstrs"><span class="hs-identifier hs-var">establishScopingConstrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100188"><span class="hs-identifier hs-var">regSelf</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681100187"><span class="hs-identifier hs-var">dataAnn</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100179"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681100177"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681100182"><span class="hs-identifier hs-var">constrsDup</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681100174"><span class="annot"><span class="annottext">datatype :: Datatype TyName Name uni NameAnn
</span><a href="#local-6989586621681100174"><span class="hs-identifier hs-var hs-var">datatype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) a.
a
-&gt; TyVarDecl tyname a
-&gt; [TyVarDecl tyname a]
-&gt; name
-&gt; [VarDecl tyname name uni a]
-&gt; Datatype tyname name uni a
</span><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-var">Datatype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#introduceBound"><span class="hs-identifier hs-var">introduceBound</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100176"><span class="hs-identifier hs-var">matchName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName NameAnn
</span><a href="#local-6989586621681100178"><span class="hs-identifier hs-var">dataDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName NameAnn]
</span><a href="#local-6989586621681100177"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100176"><span class="hs-identifier hs-var">matchName</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni NameAnn]
</span><a href="#local-6989586621681100175"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Datatype tyname name uni a -&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-var">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype TyName Name uni NameAnn
</span><a href="#local-6989586621681100174"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Reference each binding in the last one apart from itself.</span><span>
</span><span id="line-184"></span><span id="local-6989586621681100645"><span id="local-6989586621681100646"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-type">referenceViaBindings</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681100172"><span class="annot"><a href="#local-6989586621681100172"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100172"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100172"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100646"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100645"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100646"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100645"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-188"></span><span id="referenceViaBindings"><span class="annot"><span class="annottext">referenceViaBindings :: forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var hs-var">referenceViaBindings</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621681100165"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100165"><span class="hs-identifier hs-var">b0</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100165"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var">referenceViaBindings</span></a></span><span> </span><span id="local-6989586621681100164"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100164"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681100163"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100163"><span class="hs-identifier hs-var">b0</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621681100162"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100162"><span class="hs-identifier hs-var">bs0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
-&gt; Binding TyName Name uni fun NameAnn
-&gt; [Binding TyName Name uni fun NameAnn]
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681100161"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100163"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100162"><span class="hs-identifier hs-var">bs0</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621681100161"><span class="annot"><span class="annottext">go :: [Binding TyName Name uni fun NameAnn]
-&gt; Binding TyName Name uni fun NameAnn
-&gt; [Binding TyName Name uni fun NameAnn]
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681100161"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681100160"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100160"><span class="hs-identifier hs-var">prevs</span></a></span></span><span> </span><span id="local-6989586621681100159"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100159"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceVia"><span class="hs-identifier hs-var">referenceVia</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100164"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100160"><span class="hs-identifier hs-var">prevs</span></a></span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100159"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="#local-6989586621681100161"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681100156"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100156"><span class="hs-identifier hs-var">prevs</span></a></span></span><span> </span><span id="local-6989586621681100155"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100155"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681100154"><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100154"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681100153"><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100153"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100155"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
-&gt; Binding TyName Name uni fun NameAnn
-&gt; [Binding TyName Name uni fun NameAnn]
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681100161"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100155"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100156"><span class="hs-identifier hs-var">prevs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Binding TyName Name uni fun NameAnn
</span><a href="#local-6989586621681100154"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding TyName Name uni fun NameAnn]
</span><a href="#local-6989586621681100153"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Reference each binding in the first one apart from itself and in the last one also apart from</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- itself. Former bindings are always visible in latter ones and whether latter bindings are visible</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- in former ones is controlled by the first argument and ultimately depends on the recursivity</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- of the family of bindings.</span><span>
</span><span id="line-197"></span><span id="local-6989586621681100151"><span id="local-6989586621681100152"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#referenceBindingsBothWays"><span class="hs-identifier hs-type">referenceBindingsBothWays</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681100149"><span class="annot"><a href="#local-6989586621681100149"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100149"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100149"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100152"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100151"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100152"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100151"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-201"></span><span id="referenceBindingsBothWays"><span class="annot"><span class="annottext">referenceBindingsBothWays :: forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceBindingsBothWays"><span class="hs-identifier hs-var hs-var">referenceBindingsBothWays</span></a></span></span><span> </span><span id="local-6989586621681100148"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100148"><span class="hs-identifier hs-var">regRec</span></a></span></span><span>          </span><span class="hs-comment">-- Whether latter bindings are visible in former ones</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.reverse</span></a></span><span>                    </span><span class="hs-comment">-- or not depends on the recursivity and so we have</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var">referenceViaBindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100148"><span class="hs-identifier hs-var">regRec</span></a></span><span>         </span><span class="hs-comment">-- the registering function as an argument.</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.reverse</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceViaBindings"><span class="hs-identifier hs-var">referenceViaBindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span>  </span><span class="hs-comment">-- Former bindings are always visible in latter ones.</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Establish scoping for a family of bindings.</span><span>
</span><span id="line-208"></span><span id="local-6989586621681100632"><span id="local-6989586621681100633"><span id="local-6989586621681100634"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBindings"><span class="hs-identifier hs-type">establishScopingBindings</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681100141"><span class="annot"><a href="#local-6989586621681100141"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100141"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100141"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100634"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100633"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100632"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100634"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100633"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-212"></span><span id="establishScopingBindings"><span class="annot"><span class="annottext">establishScopingBindings :: forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun ann)
-&gt; Quote (NonEmpty (Binding TyName Name uni fun NameAnn))
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBindings"><span class="hs-identifier hs-var hs-var">establishScopingBindings</span></a></span></span><span> </span><span id="local-6989586621681100134"><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100134"><span class="hs-identifier hs-var">regRec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">-- Note that mutual recursion and self-recursion are handled separately.</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#referenceBindingsBothWays"><span class="hs-identifier hs-var">referenceBindingsBothWays</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100134"><span class="hs-identifier hs-var">regRec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; Binding TyName Name uni fun ann
-&gt; Quote (Binding TyName Name uni fun NameAnn)
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBinding"><span class="hs-identifier hs-var">establishScopingBinding</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="#local-6989586621681100134"><span class="hs-identifier hs-var">regRec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Return a registering function depending on the recursivity.</span><span>
</span><span id="line-217"></span><span id="local-6989586621681100623"><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-type">registerByRecursivity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#ToScopedName"><span class="hs-identifier hs-type">ToScopedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100623"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Recursivity"><span class="hs-identifier hs-type">Recursivity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681100623"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#NameAnn"><span class="hs-identifier hs-type">NameAnn</span></a></span></span><span>
</span><span id="line-218"></span><span id="registerByRecursivity"><span class="annot"><span class="annottext">registerByRecursivity :: forall name. ToScopedName name =&gt; Recursivity -&gt; name -&gt; NameAnn
</span><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-var hs-var">registerByRecursivity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerBound"><span class="hs-identifier hs-var">registerBound</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-var">registerByRecursivity</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerOutOfScope"><span class="hs-identifier hs-var">registerOutOfScope</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100650"><span id="local-6989586621681100651"><span id="local-6989586621681100652"><span id="local-6989586621681100653"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100653"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100652"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#EstablishScoping"><span class="hs-identifier hs-type">EstablishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100653"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100652"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100651"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100650"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621681100054"><span class="annot"><span class="annottext">establishScoping :: forall ann.
Term tyname name uni fun ann
-&gt; Quote (Term tyname name uni fun NameAnn)
</span><a href="#local-6989586621681100054"><span class="hs-identifier hs-var hs-var hs-var hs-var">establishScoping</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100052"><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681100052"><span class="hs-identifier hs-var">recy</span></a></span></span><span> </span><span id="local-6989586621681100051"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681100051"><span class="hs-identifier hs-var">bindingsDup</span></a></span></span><span> </span><span id="local-6989586621681100050"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100050"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621681100049"><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681100049"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann.
(forall name. ToScopedName name =&gt; name -&gt; NameAnn)
-&gt; NonEmpty (Binding TyName Name uni fun ann)
-&gt; Quote (NonEmpty (Binding TyName Name uni fun NameAnn))
</span><a href="PlutusIR.Core.Instance.Scoping.html#establishScopingBindings"><span class="hs-identifier hs-var">establishScopingBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; Recursivity -&gt; name -&gt; NameAnn
</span><a href="PlutusIR.Core.Instance.Scoping.html#registerByRecursivity"><span class="hs-identifier hs-var">registerByRecursivity</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681100052"><span class="hs-identifier hs-var">recy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681100051"><span class="hs-identifier hs-var">bindingsDup</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-comment">-- Follows the shape of 'establishScopingBinder', but subtly differs (for example,</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-comment">-- does not bind a single name, does not have a @sort@ etc), hence we write things out</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-comment">-- manually.</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceOutOfScope"><span class="hs-identifier hs-var">referenceOutOfScope</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681100049"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Recursivity
-&gt; NonEmpty (Binding tyname name uni fun a)
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681100052"><span class="hs-identifier hs-var">recy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681100049"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-229"></span><span>                </span><span class="annot"><span class="annottext">forall n (t :: * -&gt; *).
Reference n t =&gt;
n -&gt; t NameAnn -&gt; t NameAnn
</span><a href="PlutusCore.Check.Scoping.html#referenceBound"><span class="hs-identifier hs-var">referenceBound</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding TyName Name uni fun NameAnn)
</span><a href="#local-6989586621681100049"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-230"></span><span>                    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100050"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-type">LamAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100044"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100044"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681100043"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100043"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681100042"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100042"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>        </span><span id="local-6989586621681100041"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100041"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100044"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="annottext">forall name (value :: * -&gt; *) (sort :: * -&gt; *) ann.
(Reference name value, ToScopedName name, Scoping sort,
 Scoping value) =&gt;
(NameAnn -&gt; name -&gt; sort NameAnn -&gt; value NameAnn -&gt; value NameAnn)
-&gt; name -&gt; sort ann -&gt; value ann -&gt; Quote (value NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScopingBinder"><span class="hs-identifier hs-var">establishScopingBinder</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; name
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100041"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100043"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100042"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-type">TyAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100038"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681100038"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span> </span><span id="local-6989586621681100037"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100037"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681100036"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100036"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>        </span><span id="local-6989586621681100035"><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100035"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; TyName -&gt; m TyName
</span><a href="PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681100038"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><span class="annottext">forall name (value :: * -&gt; *) (sort :: * -&gt; *) ann.
(Reference name value, ToScopedName name, Scoping sort,
 Scoping value) =&gt;
(NameAnn -&gt; name -&gt; sort NameAnn -&gt; value NameAnn -&gt; value NameAnn)
-&gt; name -&gt; sort ann -&gt; value ann -&gt; Quote (value NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScopingBinder"><span class="hs-identifier hs-var">establishScopingBinder</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; tyname
-&gt; Kind a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-var">TyAbs</span></a></span><span> </span><span class="annot"><span class="annottext">TyName
</span><a href="#local-6989586621681100035"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681100037"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100036"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-type">IWrap</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100033"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100033"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681100032"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100032"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681100031"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100031"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-var">IWrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100033"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100032"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100031"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100030"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100030"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681100029"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100029"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100030"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100029"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-type">Unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100027"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100027"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-var">Unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100027"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100025"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100025"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Type tyname uni a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-var">Error</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100025"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-type">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100024"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100024"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681100023"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100023"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100024"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681100023"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100022"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100022"><span class="hs-identifier hs-var">nameDup</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>        </span><span id="local-6989586621681100021"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100021"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadQuote m =&gt; Name -&gt; m Name
</span><a href="PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681100022"><span class="hs-identifier hs-var">nameDup</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. ToScopedName name =&gt; name -&gt; NameAnn
</span><a href="PlutusCore.Check.Scoping.html#registerFree"><span class="hs-identifier hs-var">registerFree</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100021"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681100021"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100018"><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><a href="#local-6989586621681100018"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Some (ValueOf uni) -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-var">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><a href="#local-6989586621681100018"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100016"><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681100016"><span class="hs-identifier hs-var">bi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; fun -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-var">Builtin</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681100016"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100590"><span id="local-6989586621681100591"><span id="local-6989586621681100592"><span id="local-6989586621681100593"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100593"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100592"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#EstablishScoping"><span class="hs-identifier hs-type">EstablishScoping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100593"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100592"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100591"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100590"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621681100003"><span class="annot"><span class="annottext">establishScoping :: forall ann.
Program tyname name uni fun ann
-&gt; Quote (Program tyname name uni fun NameAnn)
</span><a href="#local-6989586621681100003"><span class="hs-identifier hs-var hs-var hs-var hs-var">establishScoping</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681100001"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100001"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun ann.
ann
-&gt; Term tyname name uni fun ann -&gt; Program tyname name uni fun ann
</span><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-var">Program</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="PlutusCore.Check.Scoping.html#NotAName"><span class="hs-identifier hs-var">NotAName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) ann.
EstablishScoping t =&gt;
t ann -&gt; Quote (t NameAnn)
</span><a href="PlutusCore.Check.Scoping.html#establishScoping"><span class="hs-identifier hs-var">establishScoping</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681100001"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100580"><span class="annot"><a href="#local-6989586621681100580"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100580"><span class="hs-identifier hs-type">tyname</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621681099990"><span class="annot"><span class="annottext">collectScopeInfo :: TyVarDecl tyname NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVarDecl"><span class="hs-identifier hs-type">TyVarDecl</span></a></span><span> </span><span id="local-6989586621681099988"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099988"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099987"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099987"><span class="hs-identifier hs-var">tyname</span></a></span></span><span> </span><span id="local-6989586621681099986"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099986"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099988"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099987"><span class="hs-identifier hs-var">tyname</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099986"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100572"><span id="local-6989586621681100573"><span id="local-6989586621681100574"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100574"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100573"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100574"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100573"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100572"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621681099972"><span class="annot"><span class="annottext">collectScopeInfo :: VarDecl tyname name uni NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099972"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span id="local-6989586621681099971"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099971"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099970"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099970"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681099969"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099969"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099971"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099970"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099969"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100566"><span id="local-6989586621681100567"><span id="local-6989586621681100568"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100568"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100567"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100568"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100567"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100566"><span class="hs-identifier hs-type">uni</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621681099946"><span class="annot"><span class="annottext">collectScopeInfo :: Datatype tyname name uni NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099946"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span id="local-6989586621681099945"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099945"><span class="hs-identifier hs-var">matchAnn</span></a></span></span><span> </span><span id="local-6989586621681099944"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099944"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span id="local-6989586621681099943"><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681099943"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681099942"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099942"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span id="local-6989586621681099941"><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681099941"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099944"><span class="hs-identifier hs-var">dataDecl</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl tyname NameAnn]
</span><a href="#local-6989586621681099943"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099945"><span class="hs-identifier hs-var">matchAnn</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099942"><span class="hs-identifier hs-var">matchName</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[VarDecl tyname name uni NameAnn]
</span><a href="#local-6989586621681099941"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100555"><span id="local-6989586621681100556"><span id="local-6989586621681100557"><span id="local-6989586621681100558"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100558"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100557"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100558"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100557"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100556"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100555"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621681099918"><span class="annot"><span class="annottext">collectScopeInfo :: Binding tyname name uni fun NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099918"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099917"><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099917"><span class="hs-identifier hs-var">varDecl</span></a></span></span><span> </span><span id="local-6989586621681099916"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099916"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni NameAnn
</span><a href="#local-6989586621681099917"><span class="hs-identifier hs-var">varDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099916"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099915"><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099915"><span class="hs-identifier hs-var">tyVarDecl</span></a></span></span><span> </span><span id="local-6989586621681099914"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099914"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname NameAnn
</span><a href="#local-6989586621681099915"><span class="hs-identifier hs-var">tyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099914"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099913"><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681099913"><span class="hs-identifier hs-var">datatype</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype tyname name uni NameAnn
</span><a href="#local-6989586621681099913"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100607"><span id="local-6989586621681100608"><span id="local-6989586621681100609"><span id="local-6989586621681100610"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100610"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100609"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100610"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100609"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100608"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100607"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621681099868"><span class="annot"><span class="annottext">collectScopeInfo :: Term tyname name uni fun NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099868"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099867"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun NameAnn)
</span><a href="#local-6989586621681099867"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span id="local-6989586621681099866"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099866"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun NameAnn)
</span><a href="#local-6989586621681099867"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099866"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-type">LamAbs</span></a></span><span> </span><span id="local-6989586621681099865"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099865"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099864"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099864"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681099863"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099863"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681099862"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099862"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>        </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099865"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099864"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099863"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099862"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-type">TyAbs</span></a></span><span> </span><span id="local-6989586621681099861"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099861"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099860"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099860"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681099859"><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099859"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681099858"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099858"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099861"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681099860"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Kind NameAnn
</span><a href="#local-6989586621681099859"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099858"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-type">IWrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099857"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099857"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681099856"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099856"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681099855"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099855"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099857"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099856"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099855"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099854"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099854"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681099853"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099853"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099854"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099853"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-type">Unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099852"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099852"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099852"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099851"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099851"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099851"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-type">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099850"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099850"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681099849"><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099849"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099850"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni NameAnn
</span><a href="#local-6989586621681099849"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681099848"><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099848"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681099847"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099847"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name.
ToScopedName name =&gt;
NameAnn -&gt; name -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#handleSname"><span class="hs-identifier hs-var">handleSname</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><a href="#local-6989586621681099848"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681099847"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">fun
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681100542"><span id="local-6989586621681100543"><span id="local-6989586621681100544"><span id="local-6989586621681100545"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681100545"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681100544"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Check.Scoping.html#CollectScopeInfo"><span class="hs-identifier hs-type">CollectScopeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100545"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100544"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100543"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681100542"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621681099836"><span class="annot"><span class="annottext">collectScopeInfo :: Program tyname name uni fun NameAnn -&gt; ScopeErrorOrInfo
</span><a href="#local-6989586621681099836"><span class="hs-identifier hs-var hs-var hs-var hs-var">collectScopeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><span class="annottext">NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681099835"><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099835"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *).
CollectScopeInfo t =&gt;
t NameAnn -&gt; ScopeErrorOrInfo
</span><a href="PlutusCore.Check.Scoping.html#collectScopeInfo"><span class="hs-identifier hs-var">collectScopeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun NameAnn
</span><a href="#local-6989586621681099835"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-292"></span></pre></body></html>